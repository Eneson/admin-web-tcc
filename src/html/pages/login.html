<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Login ADM Page Adote</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../../css/adminlte.css">
    <script src="http://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="../../config/api.js"></script>
</head> 

<body class="login-page bg-body-secondary">
    <div class="login-box">
        <div class="card card-outline card-primary">
            <div class="card-header"> 
                <h1 class="mb-0"> <b>ADOTE - </b>ADM
                </h1>
            </div>
            <div class="card-body login-card-body">
                <p class="login-box-msg">Faça login para começar</p>
                <form id="login_form">
                    <div class="input-group mb-1">
                        <div class="form-floating"> <input id="loginEmail" type="email" class="form-control" value="" placeholder=""> <label for="loginEmail">Email</label> </div>
                        <div class="input-group-text"> <span class="bi bi-envelope"></span> </div>
                    </div>
                    <div class="input-group mb-1">
                        <div class="form-floating"> <input id="loginPassword" type="password" class="form-control" placeholder=""> <label for="loginPassword">Senha</label> </div>
                        <div class="input-group-text"> <span class="bi bi-lock-fill"></span> </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="d-grid gap-2"> <input type="submit" value="Entrar" class="btn btn-primary"/> </div>
                        </div>
                    </div> 
                </form>                
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.3.0/browser/overlayscrollbars.browser.es6.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <script src="../../js/adminlte.js"></script>
    <script src="../../js/login.js"></script>
    <script>
        const login_form = document.querySelector("#login_form");
        login_form.addEventListener("submit", (event) => {
            //ShowLoading(true)
            event.preventDefault();
            Send_form_Login();
        });

        //ENVIAR DADOS DO FORMULÁRIO FRONTEND PARA A FUNÇÃO DE NOVO PET EM PETS.JS
        async function Send_form_Login() {
            const form_data = new FormData(login_form);            
            const loginEmail = document.getElementById('loginEmail').value
            const loginPassword = document.getElementById('loginPassword').value           
            
            form_data.append('Email', loginEmail);
            form_data.append('Senha', loginPassword);

            login(form_data).then((res) => {
                if(res.status == 200){
                    localStorage.setItem("acesso", true);
                    localStorage.setItem("token", res.token);
                    window.location.href = './index.html'
                }
            }).catch(err => {              
                alert(err);
                location.reload()
            })
        }
    

    
    </script>
</body>

</html>